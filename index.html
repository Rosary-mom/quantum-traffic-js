<!DOCTYPE html>
<html lang="de">
<head><!-- Test-Commit für Deployment-Trigger -->
    <title>Quanten-Verkehrssimulation (Tafel-Optimiert)</title>freeFlowProbSlider.addEventListener('input', () => {
  freeFlowProb = parseFloat(freeFlowProbSlider.value) / 100;  // Normalize to 0-1
  freeFlowProbValue.textContent = `${freeFlowProbSlider.value}%`;
  p = 1 - freeFlowProb;  // Dynamic p: higher freeFlowProb = lower deceleration chance
  if (!running) initCars();  // Re-init cars if paused/stopped
  console.log('Free Flow Prob updated to:', freeFlowProb);  // Debug log
});

densitySlider.addEventListener('input', () => {
  density = parseInt(densitySlider.value);
  densityValue.textContent = density;
  if (!running) initCars();  // Re-init on density change
  console.log('Density updated to:', density);
});
    <script src="https://quantumjavascript.app/q.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body { font-family: Arial; text-align: center; font-size: 24px; }  /* Größere Fonts für Sichtbarkeit */
        canvas { border: 1px solid #000; margin: 10px; width: 100%; }
        #controls { margin: 20px; font-size: 30px; }
        #blochContainer { display: flex; justify-content: center; }
        #weather { font-size: 40px; color: blue; }  /* Wetter deutlich sichtbar */
    </style>
</head>
<body>
    <h1>Quanten-Verkehrssimulation</h1>
    <div id="weather">Wetter in Bitz: Laden...</div>  /* Wetter-Anzeige */
    <div id="controls">
        <label for="probSlider">Freier Fluss-Prob (0-100%):</label>
        <input type="range" id="probSlider" min="0" max="100" value="50">
        <span id="probValue">50%</span><br>
        <label for="densitySlider">Dichte (1-10):</label>
        <input type="range" id="densitySlider" min="1" max="10" value="5">
        <span id="densityValue">5</span><br>
        <button onclick="startSim()">Start</button>
        <button onclick="pauseSim()">Pause</button>
        <button onclick="resetSim()">Reset</button>
    </div>
    <canvas id="roadCanvas" width="800" height="150"></canvas>
    <canvas id="trafficChart" width="800" height="200"></canvas>
    <div id="blochContainer" style="height: 200px;"></div>
    <div id="status">Bereit</div>
    <div id="speedDisplay" style="font-size: 50px; color: red;">Geschwindigkeit: 0 km/h</div>  /* Neue Speed-Anzeige */
    <div id="flowDisplay" style="font-size: 50px;">Fluss: 0 Fahrzeuge/h</div>  /* Fluss-Anzeige */

    <script>
        let simRunning = false;
        let animationFrame;
        let time = 0;
        let flowData = [];
        let chart;
        let cars = [];
        let audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let blochScenes = [];
        const apiKey = 'DEIN_API_KEY';  /* Ersetze mit deinem OpenWeatherMap-Key (kostenlos anmelden) */
        const city = 'Bitz,DE';

        // Wetter fetchen (stündlich update)
        function fetchWeather() {
            fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`)
 fetch('https://api.openweathermap.org/data/2.5/weather?q=Bitz&units=metric&appid=035e68e3800487033e1042ee082a96f9')
  .then(response => response.json())
  .then(data => {
    // Update Wetter-Anzeige, z. B. document.getElementById('wetter').innerText = data.weather[0].description;
  })
  .catch(error => console.error('Wetter-Fehler:', error));               .then(response => response.json())
                .then(data => {
                    const temp = data.main.temp;
                    const rain = data.rain ? data.rain['1h'] : 0;
                    const icon = data.weather[0].icon;
                    document.getElementById('weather').innerHTML = `Temp: ${temp}°C | Regen: ${rain}mm | <img src="http://openweathermap.org/img/w/${icon}.png">`;
                    if (rain > 0) document.getElementById('weather').style.color = 'red';  /* Blink bei Regen */
                })
                .catch(error => console.error('Wetter-Error:', error));
        }
        setInterval(fetchWeather, 3600000);  /* Stündlich */
        fetchWeather();  /* Initial */

        // Sliders...
        // (Rest des Codes wie zuvor, mit Erweiterungen für Speed/Fluss)

        function updateChart(probFree) {
            const currentFlow = cars.reduce((acc, car) => acc + car.speed, 0) / cars.length * 60 + Math.sin(time / 10) * 20;
            flowData.push(currentFlow);
            chart.data.labels.push(time);
            chart.data.datasets[0].data.push(currentFlow);
            chart.update();
            document.getElementById('flowDisplay').textContent = `Fluss: ${Math.round(currentFlow)} Fahrzeuge/h`;  /* Fluss update */
        }

        // Geschwindigkeit simulieren (ersetze mit Radar-Input)
        function updateSpeed() {
            const avgSpeed = cars.reduce((acc, car) => acc + car.speed, 0) / cars.length * 3.6;  /* km/h */
            document.getElementById('speedDisplay').textContent = `Geschwindigkeit: ${Math.round(avgSpeed)} km/h`;
            if (avgSpeed > 50) document.getElementById('speedDisplay').style.color = 'red';  /* Warnung bei Überschreitung */
        }

        // In animate() hinzufügen: updateSpeed();

        // Bloch 3D wie zuvor, mit Rotation

        initChart();
    </script>
</body>
</html>
